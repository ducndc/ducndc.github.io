---
layout: post
title: "Network Scanning Techniques"
subtitle: "Nmap and NSE for host discovery, service detection, and vulnerability scanning"
date: 2025-11-16 10:00:00 +0700
categories: [Hacking]
tags: [nmap, scanning, pentest, network]
author: Chung Duc Nguyen Dang
description: >
  A hands-on lab guide for performing network scanning using Nmap, including host discovery,
  OS detection, NSE scripts, and controlled DoS in lab environments.
toc: true
pin: true
---

## 1. Overview
{: #overview }

**Network scanning** is a crucial stage in penetration testing, positioned between reconnaissance and enumeration.
The goal is to identify live hosts, open ports, running services and their versions, and the operating system of targets.

---

## 2. Lab Objectives
{: #lab-objectives }

After completing this lab, you will be able to:

- Perform host discovery with various methods
- Determine OS and service versions
- Analyze raw scan packets
- Use Nmap Script Engine (NSE) for vulnerability checks
- Understand scan strategies and their risks

---

## 3. Lab Environment
{: #lab-environment }

| Component | Description |
|-----------|-------------|
| Attacker  | Kali Linux   |
| Target    | Windows/Linux VM |
| Network   | NAT or Host-only virtual network |

---




## 4. Host Discovery Techniques

![Host Discovery](/assets/img/networking/scanning.png)

Host discovery is used to identify **live hosts** on a network.

### 4.1 Ping Scan

```bash

nmap -sn <target-network>
```
üìå Identify live hosts without scanning ports.

---

### 4.2 OS Detection (SMB)

![Ping Discovery](/assets/img/networking/discoveryPing.png)

```bash

nmap -sV --script smb-os-discovery.nse <target-ip>
```

Gather OS information via SMB (port 445).

---

## 5. Service & Version Detection

```bash
nmap -sV <target-ip>
```
üìå Determines:
- Service name
- Version
- Information banner

---
### 5.1 Packet Trace

```bash
nmap -sT --packet-trace <target-ip>
```

Used for:

- Observing sent/received packets
- Analyzing scan behavior
- Understanding TCP handshake mechanisms

![OS Discovery](/assets/img/networking/os_discovery.png)

---
## 6. Port Scanning

### 6.1 Concept

![Port Scanning](/assets/img/networking/portScanning.png)

Port scanning is classified by **protocol**:

- TCP
- UDP

Example: Scan all ports TCP:

```bash
nmap -p- <target-ip>
```

---

## 7. Nmap Script Engine (NSE)

NSE allows:
- Vulnerability scanning
- Brute-force
- DoS testing
- Service enumeration

üìÇ Script location (Kali):
```bash
/usr/share/nmap/scripts/
```

---

### 7.1 Vulnerability Scan

```bash
nmap -sV -p445 --script vuln <target-ip>
```

---

### 7.2 EternalBlue Detection (MS17-010)

```bash
nmap --script smb-vuln-ms17-010 -p445 <target-ip>
```

![MS17-010](/assets/img/networking/ms17_010.png)

---

## 8. Advanced Scanning Example

```bash
nmap -sV -O -sC -v -oN nmap-win7.txt -p- <target-ip>
```

üìå Explanation:
- `-sV` : service version
- `-O` : OS detection
- `-sC` : default scripts
- `-v` : verbose
- `-oN` : output file
- `-p-` : scan all ports

---

## 9. DoS Testing with Nmap (Lab Only)

‚ö†Ô∏è **Only for use in labs / permitted environments**

### 9.1 HTTP Slowloris

```bash
nmap -Pn --script http-slowloris --max-parallelism 800 <target-ip>

```
üìå Check the DoS protection of the Apache server.

---

## 10. Lab Questions

1. How is scanning different from reconnaissance?

2. When should you use `-Pn`?

3. What are the dangers of NSE scripts?

4. Why not scan for DoS attacks on a real system?

---
## 11. Conclusion

Network scanning helps:

- Expand the attack surface
- Identify exploitation targets
- Prepare data for enumeration and exploitation

Effective scanning saves time and reduces the risk of detection.